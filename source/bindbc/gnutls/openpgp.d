module bindbc.gnutls.openpgp;

import bindbc.gnutls.gnutls;
import core.stdc.limits;
import core.sys.posix.sys.select;

enum gnutls_openpgp_crt_fmt
{
    GNUTLS_OPENPGP_FMT_RAW = 0,
    GNUTLS_OPENPGP_FMT_BASE64 = 1
}

alias gnutls_openpgp_crt_fmt_t = gnutls_openpgp_crt_fmt;

enum GNUTLS_OPENPGP_KEYID_SIZE = 8;
enum GNUTLS_OPENPGP_V4_FINGERPRINT_SIZE = 20;
alias gnutls_openpgp_keyid_t = ubyte[GNUTLS_OPENPGP_KEYID_SIZE];
enum GNUTLS_OPENPGP_MASTER_KEYID_IDX = INT_MAX;

extern(C) nothrow @nogc
{
    alias gnutls_openpgp_recv_key_func = int function (gnutls_session_t session, const(ubyte)* keyfpr, uint keyfpr_length, gnutls_datum_t* key);
}

version (BindGnuTLS_Static)
{
    extern (System) @nogc nothrow @system:

    int gnutls_openpgp_crt_init (gnutls_openpgp_crt_t* key);
    void gnutls_openpgp_crt_deinit (gnutls_openpgp_crt_t key);
    int gnutls_openpgp_crt_import (gnutls_openpgp_crt_t key, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format);
    int gnutls_openpgp_crt_export (gnutls_openpgp_crt_t key, gnutls_openpgp_crt_fmt_t format, void* output_data, size_t* output_data_size);
    int gnutls_openpgp_crt_export2 (gnutls_openpgp_crt_t key, gnutls_openpgp_crt_fmt_t format, gnutls_datum_t* out_);
    int gnutls_openpgp_crt_print (gnutls_openpgp_crt_t cert, gnutls_certificate_print_formats_t format, gnutls_datum_t* out_);
    int gnutls_openpgp_crt_get_key_usage (gnutls_openpgp_crt_t key, uint* key_usage);
    int gnutls_openpgp_crt_get_fingerprint (gnutls_openpgp_crt_t key, void* fpr, size_t* fprlen);
    int gnutls_openpgp_crt_get_subkey_fingerprint (gnutls_openpgp_crt_t key, uint idx, void* fpr, size_t* fprlen);
    int gnutls_openpgp_crt_get_name (gnutls_openpgp_crt_t key, int idx, char* buf, size_t* sizeof_buf);
    gnutls_pk_algorithm_t gnutls_openpgp_crt_get_pk_algorithm (gnutls_openpgp_crt_t key, uint* bits);
    int gnutls_openpgp_crt_get_version (gnutls_openpgp_crt_t key);
    time_t gnutls_openpgp_crt_get_creation_time (gnutls_openpgp_crt_t key);
    time_t gnutls_openpgp_crt_get_expiration_time (gnutls_openpgp_crt_t key);
    int gnutls_openpgp_crt_get_key_id (gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_crt_check_hostname (gnutls_openpgp_crt_t key, const(char)* hostname);
    int gnutls_openpgp_crt_check_hostname2 (gnutls_openpgp_crt_t key, const(char)* hostname, uint flags);
    int gnutls_openpgp_crt_check_email (gnutls_openpgp_crt_t key, const(char)* email, uint flags);
    int gnutls_openpgp_crt_get_revoked_status (gnutls_openpgp_crt_t key);
    int gnutls_openpgp_crt_get_subkey_count (gnutls_openpgp_crt_t key);
    int gnutls_openpgp_crt_get_subkey_idx (gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_crt_get_subkey_revoked_status (gnutls_openpgp_crt_t key, uint idx);
    gnutls_pk_algorithm_t gnutls_openpgp_crt_get_subkey_pk_algorithm (gnutls_openpgp_crt_t key, uint idx, uint* bits);
    time_t gnutls_openpgp_crt_get_subkey_creation_time (gnutls_openpgp_crt_t key, uint idx);
    time_t gnutls_openpgp_crt_get_subkey_expiration_time (gnutls_openpgp_crt_t key, uint idx);
    int gnutls_openpgp_crt_get_subkey_id (gnutls_openpgp_crt_t key, uint idx, gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_crt_get_subkey_usage (gnutls_openpgp_crt_t key, uint idx, uint* key_usage);
    int gnutls_openpgp_crt_get_subkey_pk_dsa_raw (gnutls_openpgp_crt_t crt, uint idx, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y);
    int gnutls_openpgp_crt_get_subkey_pk_rsa_raw (gnutls_openpgp_crt_t crt, uint idx, gnutls_datum_t* m, gnutls_datum_t* e);
    int gnutls_openpgp_crt_get_pk_dsa_raw (gnutls_openpgp_crt_t crt, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y);
    int gnutls_openpgp_crt_get_pk_rsa_raw (gnutls_openpgp_crt_t crt, gnutls_datum_t* m, gnutls_datum_t* e);
    int gnutls_openpgp_crt_get_preferred_key_id (gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_crt_set_preferred_key_id (gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_privkey_init (gnutls_openpgp_privkey_t* key);
    void gnutls_openpgp_privkey_deinit (gnutls_openpgp_privkey_t key);
    gnutls_pk_algorithm_t gnutls_openpgp_privkey_get_pk_algorithm (gnutls_openpgp_privkey_t key, uint* bits);
    gnutls_sec_param_t gnutls_openpgp_privkey_sec_param (gnutls_openpgp_privkey_t key);
    int gnutls_openpgp_privkey_import (gnutls_openpgp_privkey_t key, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags);
    int gnutls_openpgp_privkey_get_fingerprint (gnutls_openpgp_privkey_t key, void* fpr, size_t* fprlen);
    int gnutls_openpgp_privkey_get_subkey_fingerprint (gnutls_openpgp_privkey_t key, uint idx, void* fpr, size_t* fprlen);
    int gnutls_openpgp_privkey_get_key_id (gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_privkey_get_subkey_count (gnutls_openpgp_privkey_t key);
    int gnutls_openpgp_privkey_get_subkey_idx (gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_privkey_get_subkey_revoked_status (gnutls_openpgp_privkey_t key, uint idx);
    int gnutls_openpgp_privkey_get_revoked_status (gnutls_openpgp_privkey_t key);
    gnutls_pk_algorithm_t gnutls_openpgp_privkey_get_subkey_pk_algorithm (gnutls_openpgp_privkey_t key, uint idx, uint* bits);
    time_t gnutls_openpgp_privkey_get_subkey_expiration_time (gnutls_openpgp_privkey_t key, uint idx);
    int gnutls_openpgp_privkey_get_subkey_id (gnutls_openpgp_privkey_t key, uint idx, gnutls_openpgp_keyid_t keyid);
    time_t gnutls_openpgp_privkey_get_subkey_creation_time (gnutls_openpgp_privkey_t key, uint idx);
    int gnutls_openpgp_privkey_export_subkey_dsa_raw (gnutls_openpgp_privkey_t pkey, uint idx, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y, gnutls_datum_t* x);
    int gnutls_openpgp_privkey_export_subkey_rsa_raw (gnutls_openpgp_privkey_t pkey, uint idx, gnutls_datum_t* m, gnutls_datum_t* e, gnutls_datum_t* d, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* u);
    int gnutls_openpgp_privkey_export_dsa_raw (gnutls_openpgp_privkey_t pkey, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y, gnutls_datum_t* x);
    int gnutls_openpgp_privkey_export_rsa_raw (gnutls_openpgp_privkey_t pkey, gnutls_datum_t* m, gnutls_datum_t* e, gnutls_datum_t* d, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* u);
    int gnutls_openpgp_privkey_export (gnutls_openpgp_privkey_t key, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags, void* output_data, size_t* output_data_size);
    int gnutls_openpgp_privkey_export2 (gnutls_openpgp_privkey_t key, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags, gnutls_datum_t* out_);
    int gnutls_openpgp_privkey_set_preferred_key_id (gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_privkey_get_preferred_key_id (gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid);
    int gnutls_openpgp_crt_get_auth_subkey (gnutls_openpgp_crt_t crt, gnutls_openpgp_keyid_t keyid, uint flag);
    int gnutls_openpgp_keyring_init (gnutls_openpgp_keyring_t* keyring);
    void gnutls_openpgp_keyring_deinit (gnutls_openpgp_keyring_t keyring);
    int gnutls_openpgp_keyring_import (gnutls_openpgp_keyring_t keyring, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format);
    int gnutls_openpgp_keyring_check_id (gnutls_openpgp_keyring_t ring, const gnutls_openpgp_keyid_t keyid, uint flags);
    int gnutls_openpgp_crt_verify_ring (gnutls_openpgp_crt_t key, gnutls_openpgp_keyring_t keyring, uint flags, uint* verify);
    int gnutls_openpgp_crt_verify_self (gnutls_openpgp_crt_t key, uint flags, uint* verify);
    int gnutls_openpgp_keyring_get_crt (gnutls_openpgp_keyring_t ring, uint idx, gnutls_openpgp_crt_t* cert);
    int gnutls_openpgp_keyring_get_crt_count (gnutls_openpgp_keyring_t ring);
    void gnutls_openpgp_set_recv_key_function (gnutls_session_t session, gnutls_openpgp_recv_key_func func);
    int gnutls_certificate_set_openpgp_key (gnutls_certificate_credentials_t res, gnutls_openpgp_crt_t crt, gnutls_openpgp_privkey_t pkey);
    int gnutls_certificate_get_openpgp_key (gnutls_certificate_credentials_t res, uint index, gnutls_openpgp_privkey_t* key);
    int gnutls_certificate_get_openpgp_crt (gnutls_certificate_credentials_t res, uint index, gnutls_openpgp_crt_t** crt_list, uint* crt_list_size);
    int gnutls_certificate_set_openpgp_key_file (gnutls_certificate_credentials_t res, const(char)* certfile, const(char)* keyfile, gnutls_openpgp_crt_fmt_t format);
    int gnutls_certificate_set_openpgp_key_mem (gnutls_certificate_credentials_t res, const(gnutls_datum_t)* cert, const(gnutls_datum_t)* key, gnutls_openpgp_crt_fmt_t format);
    int gnutls_certificate_set_openpgp_key_file2 (gnutls_certificate_credentials_t res, const(char)* certfile, const(char)* keyfile, const(char)* subkey_id, gnutls_openpgp_crt_fmt_t format);
    int gnutls_certificate_set_openpgp_key_mem2 (gnutls_certificate_credentials_t res, const(gnutls_datum_t)* cert, const(gnutls_datum_t)* key, const(char)* subkey_id, gnutls_openpgp_crt_fmt_t format);
    int gnutls_certificate_set_openpgp_keyring_mem (gnutls_certificate_credentials_t c, const(ubyte)* data, size_t dlen, gnutls_openpgp_crt_fmt_t format);
    int gnutls_certificate_set_openpgp_keyring_file (gnutls_certificate_credentials_t c, const(char)* file, gnutls_openpgp_crt_fmt_t format);
}
else
{
    extern (System) @nogc nothrow @system
    {
        alias pgnutls_openpgp_crt_init = int function (gnutls_openpgp_crt_t* key);
        alias pgnutls_openpgp_crt_deinit = void function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_import = int function (gnutls_openpgp_crt_t key, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_openpgp_crt_export = int function (gnutls_openpgp_crt_t key, gnutls_openpgp_crt_fmt_t format, void* output_data, size_t* output_data_size);
        alias pgnutls_openpgp_crt_export2 = int function (gnutls_openpgp_crt_t key, gnutls_openpgp_crt_fmt_t format, gnutls_datum_t* out_);
        alias pgnutls_openpgp_crt_print = int function (gnutls_openpgp_crt_t cert, gnutls_certificate_print_formats_t format, gnutls_datum_t* out_);
        alias pgnutls_openpgp_crt_get_key_usage = int function (gnutls_openpgp_crt_t key, uint* key_usage);
        alias pgnutls_openpgp_crt_get_fingerprint = int function (gnutls_openpgp_crt_t key, void* fpr, size_t* fprlen);
        alias pgnutls_openpgp_crt_get_subkey_fingerprint = int function (gnutls_openpgp_crt_t key, uint idx, void* fpr, size_t* fprlen);
        alias pgnutls_openpgp_crt_get_name = int function (gnutls_openpgp_crt_t key, int idx, char* buf, size_t* sizeof_buf);
        alias pgnutls_openpgp_crt_get_pk_algorithm = gnutls_pk_algorithm_t function (gnutls_openpgp_crt_t key, uint* bits);
        alias pgnutls_openpgp_crt_get_version = int function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_get_creation_time = time_t function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_get_expiration_time = time_t function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_get_key_id = int function (gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_crt_check_hostname = int function (gnutls_openpgp_crt_t key, const(char)* hostname);
        alias pgnutls_openpgp_crt_check_hostname2 = int function (gnutls_openpgp_crt_t key, const(char)* hostname, uint flags);
        alias pgnutls_openpgp_crt_check_email = int function (gnutls_openpgp_crt_t key, const(char)* email, uint flags);
        alias pgnutls_openpgp_crt_get_revoked_status = int function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_get_subkey_count = int function (gnutls_openpgp_crt_t key);
        alias pgnutls_openpgp_crt_get_subkey_idx = int function (gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_crt_get_subkey_revoked_status = int function (gnutls_openpgp_crt_t key, uint idx);
        alias pgnutls_openpgp_crt_get_subkey_pk_algorithm = gnutls_pk_algorithm_t function (gnutls_openpgp_crt_t key, uint idx, uint* bits);
        alias pgnutls_openpgp_crt_get_subkey_creation_time = time_t function (gnutls_openpgp_crt_t key, uint idx);
        alias pgnutls_openpgp_crt_get_subkey_expiration_time = time_t function (gnutls_openpgp_crt_t key, uint idx);
        alias pgnutls_openpgp_crt_get_subkey_id = int function (gnutls_openpgp_crt_t key, uint idx, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_crt_get_subkey_usage = int function (gnutls_openpgp_crt_t key, uint idx, uint* key_usage);
        alias pgnutls_openpgp_crt_get_subkey_pk_dsa_raw = int function (gnutls_openpgp_crt_t crt, uint idx, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y);
        alias pgnutls_openpgp_crt_get_subkey_pk_rsa_raw = int function (gnutls_openpgp_crt_t crt, uint idx, gnutls_datum_t* m, gnutls_datum_t* e);
        alias pgnutls_openpgp_crt_get_pk_dsa_raw = int function (gnutls_openpgp_crt_t crt, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y);
        alias pgnutls_openpgp_crt_get_pk_rsa_raw = int function (gnutls_openpgp_crt_t crt, gnutls_datum_t* m, gnutls_datum_t* e);
        alias pgnutls_openpgp_crt_get_preferred_key_id = int function (gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_crt_set_preferred_key_id = int function (gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_privkey_init = int function (gnutls_openpgp_privkey_t* key);
        alias pgnutls_openpgp_privkey_deinit = void function (gnutls_openpgp_privkey_t key);
        alias pgnutls_openpgp_privkey_get_pk_algorithm = gnutls_pk_algorithm_t function (gnutls_openpgp_privkey_t key, uint* bits);
        alias pgnutls_openpgp_privkey_sec_param = gnutls_sec_param_t function (gnutls_openpgp_privkey_t key);
        alias pgnutls_openpgp_privkey_import = int function (gnutls_openpgp_privkey_t key, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags);
        alias pgnutls_openpgp_privkey_get_fingerprint = int function (gnutls_openpgp_privkey_t key, void* fpr, size_t* fprlen);
        alias pgnutls_openpgp_privkey_get_subkey_fingerprint = int function (gnutls_openpgp_privkey_t key, uint idx, void* fpr, size_t* fprlen);
        alias pgnutls_openpgp_privkey_get_key_id = int function (gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_privkey_get_subkey_count = int function (gnutls_openpgp_privkey_t key);
        alias pgnutls_openpgp_privkey_get_subkey_idx = int function (gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_privkey_get_subkey_revoked_status = int function (gnutls_openpgp_privkey_t key, uint idx);
        alias pgnutls_openpgp_privkey_get_revoked_status = int function (gnutls_openpgp_privkey_t key);
        alias pgnutls_openpgp_privkey_get_subkey_pk_algorithm = gnutls_pk_algorithm_t function (gnutls_openpgp_privkey_t key, uint idx, uint* bits);
        alias pgnutls_openpgp_privkey_get_subkey_expiration_time = time_t function (gnutls_openpgp_privkey_t key, uint idx);
        alias pgnutls_openpgp_privkey_get_subkey_id = int function (gnutls_openpgp_privkey_t key, uint idx, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_privkey_get_subkey_creation_time = time_t function (gnutls_openpgp_privkey_t key, uint idx);
        alias pgnutls_openpgp_privkey_export_subkey_dsa_raw = int function (gnutls_openpgp_privkey_t pkey, uint idx, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y, gnutls_datum_t* x);
        alias pgnutls_openpgp_privkey_export_subkey_rsa_raw = int function (gnutls_openpgp_privkey_t pkey, uint idx, gnutls_datum_t* m, gnutls_datum_t* e, gnutls_datum_t* d, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* u);
        alias pgnutls_openpgp_privkey_export_dsa_raw = int function (gnutls_openpgp_privkey_t pkey, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* g, gnutls_datum_t* y, gnutls_datum_t* x);
        alias pgnutls_openpgp_privkey_export_rsa_raw = int function (gnutls_openpgp_privkey_t pkey, gnutls_datum_t* m, gnutls_datum_t* e, gnutls_datum_t* d, gnutls_datum_t* p, gnutls_datum_t* q, gnutls_datum_t* u);
        alias pgnutls_openpgp_privkey_export = int function (gnutls_openpgp_privkey_t key, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags, void* output_data, size_t* output_data_size);
        alias pgnutls_openpgp_privkey_export2 = int function (gnutls_openpgp_privkey_t key, gnutls_openpgp_crt_fmt_t format, const(char)* password, uint flags, gnutls_datum_t* out_);
        alias pgnutls_openpgp_privkey_set_preferred_key_id = int function (gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_privkey_get_preferred_key_id = int function (gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid);
        alias pgnutls_openpgp_crt_get_auth_subkey = int function (gnutls_openpgp_crt_t crt, gnutls_openpgp_keyid_t keyid, uint flag);
        alias pgnutls_openpgp_keyring_init = int function (gnutls_openpgp_keyring_t* keyring);
        alias pgnutls_openpgp_keyring_deinit = void function (gnutls_openpgp_keyring_t keyring);
        alias pgnutls_openpgp_keyring_import = int function (gnutls_openpgp_keyring_t keyring, const(gnutls_datum_t)* data, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_openpgp_keyring_check_id = int function (gnutls_openpgp_keyring_t ring, const gnutls_openpgp_keyid_t keyid, uint flags);
        alias pgnutls_openpgp_crt_verify_ring = int function (gnutls_openpgp_crt_t key, gnutls_openpgp_keyring_t keyring, uint flags, uint* verify);
        alias pgnutls_openpgp_crt_verify_self = int function (gnutls_openpgp_crt_t key, uint flags, uint* verify);
        alias pgnutls_openpgp_keyring_get_crt = int function (gnutls_openpgp_keyring_t ring, uint idx, gnutls_openpgp_crt_t* cert);
        alias pgnutls_openpgp_keyring_get_crt_count = int function (gnutls_openpgp_keyring_t ring);
        alias pgnutls_openpgp_set_recv_key_function = void function (gnutls_session_t session, gnutls_openpgp_recv_key_func func);
        alias pgnutls_certificate_set_openpgp_key = int function (gnutls_certificate_credentials_t res, gnutls_openpgp_crt_t crt, gnutls_openpgp_privkey_t pkey);
        alias pgnutls_certificate_get_openpgp_key = int function (gnutls_certificate_credentials_t res, uint index, gnutls_openpgp_privkey_t* key);
        alias pgnutls_certificate_get_openpgp_crt = int function (gnutls_certificate_credentials_t res, uint index, gnutls_openpgp_crt_t** crt_list, uint* crt_list_size);
        alias pgnutls_certificate_set_openpgp_key_file = int function (gnutls_certificate_credentials_t res, const(char)* certfile, const(char)* keyfile, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_certificate_set_openpgp_key_mem = int function (gnutls_certificate_credentials_t res, const(gnutls_datum_t)* cert, const(gnutls_datum_t)* key, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_certificate_set_openpgp_key_file2 = int function (gnutls_certificate_credentials_t res, const(char)* certfile, const(char)* keyfile, const(char)* subkey_id, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_certificate_set_openpgp_key_mem2 = int function (gnutls_certificate_credentials_t res, const(gnutls_datum_t)* cert, const(gnutls_datum_t)* key, const(char)* subkey_id, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_certificate_set_openpgp_keyring_mem = int function (gnutls_certificate_credentials_t c, const(ubyte)* data, size_t dlen, gnutls_openpgp_crt_fmt_t format);
        alias pgnutls_certificate_set_openpgp_keyring_file = int function (gnutls_certificate_credentials_t c, const(char)* file, gnutls_openpgp_crt_fmt_t format);
    }

    __gshared
    {
        pgnutls_openpgp_crt_init gnutls_openpgp_crt_init;
        pgnutls_openpgp_crt_deinit gnutls_openpgp_crt_deinit;
        pgnutls_openpgp_crt_import gnutls_openpgp_crt_import;
        pgnutls_openpgp_crt_export gnutls_openpgp_crt_export;
        pgnutls_openpgp_crt_export2 gnutls_openpgp_crt_export2;
        pgnutls_openpgp_crt_print gnutls_openpgp_crt_print;
        pgnutls_openpgp_crt_get_key_usage gnutls_openpgp_crt_get_key_usage;
        pgnutls_openpgp_crt_get_fingerprint gnutls_openpgp_crt_get_fingerprint;
        pgnutls_openpgp_crt_get_subkey_fingerprint gnutls_openpgp_crt_get_subkey_fingerprint;
        pgnutls_openpgp_crt_get_name gnutls_openpgp_crt_get_name;
        pgnutls_openpgp_crt_get_pk_algorithm gnutls_openpgp_crt_get_pk_algorithm;
        pgnutls_openpgp_crt_get_version gnutls_openpgp_crt_get_version;
        pgnutls_openpgp_crt_get_creation_time gnutls_openpgp_crt_get_creation_time;
        pgnutls_openpgp_crt_get_expiration_time gnutls_openpgp_crt_get_expiration_time;
        pgnutls_openpgp_crt_get_key_id gnutls_openpgp_crt_get_key_id;
        pgnutls_openpgp_crt_check_hostname gnutls_openpgp_crt_check_hostname;
        pgnutls_openpgp_crt_check_hostname2 gnutls_openpgp_crt_check_hostname2;
        pgnutls_openpgp_crt_check_email gnutls_openpgp_crt_check_email;
        pgnutls_openpgp_crt_get_revoked_status gnutls_openpgp_crt_get_revoked_status;
        pgnutls_openpgp_crt_get_subkey_count gnutls_openpgp_crt_get_subkey_count;
        pgnutls_openpgp_crt_get_subkey_idx gnutls_openpgp_crt_get_subkey_idx;
        pgnutls_openpgp_crt_get_subkey_revoked_status gnutls_openpgp_crt_get_subkey_revoked_status;
        pgnutls_openpgp_crt_get_subkey_pk_algorithm gnutls_openpgp_crt_get_subkey_pk_algorithm;
        pgnutls_openpgp_crt_get_subkey_creation_time gnutls_openpgp_crt_get_subkey_creation_time;
        pgnutls_openpgp_crt_get_subkey_expiration_time gnutls_openpgp_crt_get_subkey_expiration_time;
        pgnutls_openpgp_crt_get_subkey_id gnutls_openpgp_crt_get_subkey_id;
        pgnutls_openpgp_crt_get_subkey_usage gnutls_openpgp_crt_get_subkey_usage;
        pgnutls_openpgp_crt_get_subkey_pk_dsa_raw gnutls_openpgp_crt_get_subkey_pk_dsa_raw;
        pgnutls_openpgp_crt_get_subkey_pk_rsa_raw gnutls_openpgp_crt_get_subkey_pk_rsa_raw;
        pgnutls_openpgp_crt_get_pk_dsa_raw gnutls_openpgp_crt_get_pk_dsa_raw;
        pgnutls_openpgp_crt_get_pk_rsa_raw gnutls_openpgp_crt_get_pk_rsa_raw;
        pgnutls_openpgp_crt_get_preferred_key_id gnutls_openpgp_crt_get_preferred_key_id;
        pgnutls_openpgp_crt_set_preferred_key_id gnutls_openpgp_crt_set_preferred_key_id;
        pgnutls_openpgp_privkey_init gnutls_openpgp_privkey_init;
        pgnutls_openpgp_privkey_deinit gnutls_openpgp_privkey_deinit;
        pgnutls_openpgp_privkey_get_pk_algorithm gnutls_openpgp_privkey_get_pk_algorithm;
        pgnutls_openpgp_privkey_sec_param gnutls_openpgp_privkey_sec_param;
        pgnutls_openpgp_privkey_import gnutls_openpgp_privkey_import;
        pgnutls_openpgp_privkey_get_fingerprint gnutls_openpgp_privkey_get_fingerprint;
        pgnutls_openpgp_privkey_get_subkey_fingerprint gnutls_openpgp_privkey_get_subkey_fingerprint;
        pgnutls_openpgp_privkey_get_key_id gnutls_openpgp_privkey_get_key_id;
        pgnutls_openpgp_privkey_get_subkey_count gnutls_openpgp_privkey_get_subkey_count;
        pgnutls_openpgp_privkey_get_subkey_idx gnutls_openpgp_privkey_get_subkey_idx;
        pgnutls_openpgp_privkey_get_subkey_revoked_status gnutls_openpgp_privkey_get_subkey_revoked_status;
        pgnutls_openpgp_privkey_get_revoked_status gnutls_openpgp_privkey_get_revoked_status;
        pgnutls_openpgp_privkey_get_subkey_pk_algorithm gnutls_openpgp_privkey_get_subkey_pk_algorithm;
        pgnutls_openpgp_privkey_get_subkey_expiration_time gnutls_openpgp_privkey_get_subkey_expiration_time;
        pgnutls_openpgp_privkey_get_subkey_id gnutls_openpgp_privkey_get_subkey_id;
        pgnutls_openpgp_privkey_get_subkey_creation_time gnutls_openpgp_privkey_get_subkey_creation_time;
        pgnutls_openpgp_privkey_export_subkey_dsa_raw gnutls_openpgp_privkey_export_subkey_dsa_raw;
        pgnutls_openpgp_privkey_export_subkey_rsa_raw gnutls_openpgp_privkey_export_subkey_rsa_raw;
        pgnutls_openpgp_privkey_export_dsa_raw gnutls_openpgp_privkey_export_dsa_raw;
        pgnutls_openpgp_privkey_export_rsa_raw gnutls_openpgp_privkey_export_rsa_raw;
        pgnutls_openpgp_privkey_export gnutls_openpgp_privkey_export;
        pgnutls_openpgp_privkey_export2 gnutls_openpgp_privkey_export2;
        pgnutls_openpgp_privkey_set_preferred_key_id gnutls_openpgp_privkey_set_preferred_key_id;
        pgnutls_openpgp_privkey_get_preferred_key_id gnutls_openpgp_privkey_get_preferred_key_id;
        pgnutls_openpgp_crt_get_auth_subkey gnutls_openpgp_crt_get_auth_subkey;
        pgnutls_openpgp_keyring_init gnutls_openpgp_keyring_init;
        pgnutls_openpgp_keyring_deinit gnutls_openpgp_keyring_deinit;
        pgnutls_openpgp_keyring_import gnutls_openpgp_keyring_import;
        pgnutls_openpgp_keyring_check_id gnutls_openpgp_keyring_check_id;
        pgnutls_openpgp_crt_verify_ring gnutls_openpgp_crt_verify_ring;
        pgnutls_openpgp_crt_verify_self gnutls_openpgp_crt_verify_self;
        pgnutls_openpgp_keyring_get_crt gnutls_openpgp_keyring_get_crt;
        pgnutls_openpgp_keyring_get_crt_count gnutls_openpgp_keyring_get_crt_count;
        pgnutls_openpgp_set_recv_key_function gnutls_openpgp_set_recv_key_function;
        pgnutls_certificate_set_openpgp_key gnutls_certificate_set_openpgp_key;
        pgnutls_certificate_get_openpgp_key gnutls_certificate_get_openpgp_key;
        pgnutls_certificate_get_openpgp_crt gnutls_certificate_get_openpgp_crt;
        pgnutls_certificate_set_openpgp_key_file gnutls_certificate_set_openpgp_key_file;
        pgnutls_certificate_set_openpgp_key_mem gnutls_certificate_set_openpgp_key_mem;
        pgnutls_certificate_set_openpgp_key_file2 gnutls_certificate_set_openpgp_key_file2;
        pgnutls_certificate_set_openpgp_key_mem2 gnutls_certificate_set_openpgp_key_mem2;
        pgnutls_certificate_set_openpgp_keyring_mem gnutls_certificate_set_openpgp_keyring_mem;
        pgnutls_certificate_set_openpgp_keyring_file gnutls_certificate_set_openpgp_keyring_file;
    }

    import bindbc.loader : SharedLib, bindSymbol_stdcall;
    void bindOpenPGP(SharedLib lib)
    {
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_init, "gnutls_openpgp_crt_init");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_deinit, "gnutls_openpgp_crt_deinit");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_import, "gnutls_openpgp_crt_import");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_export, "gnutls_openpgp_crt_export");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_export2, "gnutls_openpgp_crt_export2");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_print, "gnutls_openpgp_crt_print");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_key_usage, "gnutls_openpgp_crt_get_key_usage");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_fingerprint, "gnutls_openpgp_crt_get_fingerprint");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_fingerprint, "gnutls_openpgp_crt_get_subkey_fingerprint");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_name, "gnutls_openpgp_crt_get_name");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_pk_algorithm, "gnutls_openpgp_crt_get_pk_algorithm");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_version, "gnutls_openpgp_crt_get_version");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_creation_time, "gnutls_openpgp_crt_get_creation_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_expiration_time, "gnutls_openpgp_crt_get_expiration_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_key_id, "gnutls_openpgp_crt_get_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_check_hostname, "gnutls_openpgp_crt_check_hostname");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_check_hostname2, "gnutls_openpgp_crt_check_hostname2");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_check_email, "gnutls_openpgp_crt_check_email");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_revoked_status, "gnutls_openpgp_crt_get_revoked_status");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_count, "gnutls_openpgp_crt_get_subkey_count");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_idx, "gnutls_openpgp_crt_get_subkey_idx");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_revoked_status, "gnutls_openpgp_crt_get_subkey_revoked_status");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_pk_algorithm, "gnutls_openpgp_crt_get_subkey_pk_algorithm");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_creation_time, "gnutls_openpgp_crt_get_subkey_creation_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_expiration_time, "gnutls_openpgp_crt_get_subkey_expiration_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_id, "gnutls_openpgp_crt_get_subkey_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_usage, "gnutls_openpgp_crt_get_subkey_usage");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_pk_dsa_raw, "gnutls_openpgp_crt_get_subkey_pk_dsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_subkey_pk_rsa_raw, "gnutls_openpgp_crt_get_subkey_pk_rsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_pk_dsa_raw, "gnutls_openpgp_crt_get_pk_dsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_pk_rsa_raw, "gnutls_openpgp_crt_get_pk_rsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_preferred_key_id, "gnutls_openpgp_crt_get_preferred_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_set_preferred_key_id, "gnutls_openpgp_crt_set_preferred_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_init, "gnutls_openpgp_privkey_init");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_deinit, "gnutls_openpgp_privkey_deinit");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_pk_algorithm, "gnutls_openpgp_privkey_get_pk_algorithm");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_sec_param, "gnutls_openpgp_privkey_sec_param");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_import, "gnutls_openpgp_privkey_import");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_fingerprint, "gnutls_openpgp_privkey_get_fingerprint");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_fingerprint, "gnutls_openpgp_privkey_get_subkey_fingerprint");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_key_id, "gnutls_openpgp_privkey_get_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_count, "gnutls_openpgp_privkey_get_subkey_count");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_idx, "gnutls_openpgp_privkey_get_subkey_idx");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_revoked_status, "gnutls_openpgp_privkey_get_subkey_revoked_status");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_revoked_status, "gnutls_openpgp_privkey_get_revoked_status");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_pk_algorithm, "gnutls_openpgp_privkey_get_subkey_pk_algorithm");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_expiration_time, "gnutls_openpgp_privkey_get_subkey_expiration_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_id, "gnutls_openpgp_privkey_get_subkey_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_subkey_creation_time, "gnutls_openpgp_privkey_get_subkey_creation_time");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export_subkey_dsa_raw, "gnutls_openpgp_privkey_export_subkey_dsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export_subkey_rsa_raw, "gnutls_openpgp_privkey_export_subkey_rsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export_dsa_raw, "gnutls_openpgp_privkey_export_dsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export_rsa_raw, "gnutls_openpgp_privkey_export_rsa_raw");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export, "gnutls_openpgp_privkey_export");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_export2, "gnutls_openpgp_privkey_export2");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_set_preferred_key_id, "gnutls_openpgp_privkey_set_preferred_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_privkey_get_preferred_key_id, "gnutls_openpgp_privkey_get_preferred_key_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_get_auth_subkey, "gnutls_openpgp_crt_get_auth_subkey");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_init, "gnutls_openpgp_keyring_init");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_deinit, "gnutls_openpgp_keyring_deinit");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_import, "gnutls_openpgp_keyring_import");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_check_id, "gnutls_openpgp_keyring_check_id");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_verify_ring, "gnutls_openpgp_crt_verify_ring");
        lib.bindSymbol_stdcall(gnutls_openpgp_crt_verify_self, "gnutls_openpgp_crt_verify_self");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_get_crt, "gnutls_openpgp_keyring_get_crt");
        lib.bindSymbol_stdcall(gnutls_openpgp_keyring_get_crt_count, "gnutls_openpgp_keyring_get_crt_count");
        lib.bindSymbol_stdcall(gnutls_openpgp_set_recv_key_function, "gnutls_openpgp_set_recv_key_function");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_key, "gnutls_certificate_set_openpgp_key");
        lib.bindSymbol_stdcall(gnutls_certificate_get_openpgp_key, "gnutls_certificate_get_openpgp_key");
        lib.bindSymbol_stdcall(gnutls_certificate_get_openpgp_crt, "gnutls_certificate_get_openpgp_crt");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_key_file, "gnutls_certificate_set_openpgp_key_file");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_key_mem, "gnutls_certificate_set_openpgp_key_mem");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_key_file2, "gnutls_certificate_set_openpgp_key_file2");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_key_mem2, "gnutls_certificate_set_openpgp_key_mem2");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_keyring_mem, "gnutls_certificate_set_openpgp_keyring_mem");
        lib.bindSymbol_stdcall(gnutls_certificate_set_openpgp_keyring_file, "gnutls_certificate_set_openpgp_keyring_file");
    }
}
